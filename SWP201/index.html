<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="SWP201 - Hệ thống đổi pin xe máy điện thông minh - Quản lý người dùng, trạm, thanh toán với bản đồ tương tác" />
  <title>SWP201 - Hệ Thống Đổi Pin Xe Máy Điện</title>
  
  <!-- External CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
  
  <!-- Internal CSS -->
  <link rel="stylesheet" href="src/assets/css/main.css" />
  <link rel="stylesheet" href="src/assets/css/modals.css" />
  <link rel="stylesheet" href="src/assets/css/dashboard.css" />
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M6 3h6l-1.5 3H7.8L6 3zm12 18h-6l1.5-3h2.7L18 21zM5 9h9l-1.5 3H6.5L5 9zm14 6h-9l1.5-3h6.5L19 15z"/></svg>
        </div>
        SWP201
      </div>
      <nav class="nav-links">
        <a href="#features">Tính năng</a>
        <a href="#pricing">Bảng giá</a>
        <a href="#stations">Trạm</a>
        <a href="#contact">Liên hệ</a>
      </nav>
      <div class="auth-buttons">
        <button class="btn" onclick="showLogin()">Đăng nhập</button>
        <button class="btn btn-primary" onclick="showRegister()">Đăng ký</button>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <div class="eyebrow">SWP201 • Đổi pin trong 3 phút • Thanh toán thông minh • Quản lý tự động</div>
        <h1 class="title">SWP201: Hệ thống <strong>đổi pin xe điện</strong> thông minh</h1>
        <p class="subtitle">Nền tảng quản lý toàn diện cho người dùng, nhân viên và quản trị viên. Tích hợp bản đồ, thanh toán và theo dõi real-time.</p>
        <div class="hero-actions">
          <button class="btn btn-primary" onclick="showLogin()">Truy cập hệ thống</button>
          <button class="btn" onclick="scrollToId('stations')">Xem bản đồ trạm</button>
        </div>
      </div>
    </section>

    <section id="features">
      <div class="container">
        <h2>Tính năng hệ thống</h2>
        <div class="grid">
          <div class="card">
            <div class="icon">👤</div>
            <h3>Dashboard người dùng</h3>
            <p class="muted">Theo dõi lịch sử đổi pin, thanh toán, tìm trạm gần nhất và đặt lịch online.</p>
          </div>
          <div class="card">
            <div class="icon">👨‍💼</div>
            <h3>Dashboard nhân viên</h3>
            <p class="muted">Quản lý trạm, theo dõi tình trạng pin, xử lý yêu cầu khách hàng.</p>
          </div>
          <div class="card">
            <div class="icon">⚙️</div>
            <h3>Dashboard quản trị</h3>
            <p class="muted">Thống kê toàn hệ thống, quản lý người dùng, cấu hình và báo cáo.</p>
          </div>
          <div class="card">
            <div class="icon">🗺️</div>
            <h3>Bản đồ tương tác</h3>
            <p class="muted">Tìm trạm theo vị trí, xem tình trạng real-time, điều hướng GPS.</p>
          </div>
          <div class="card">
            <div class="icon">💳</div>
            <h3>Thanh toán thông minh</h3>
            <p class="muted">Nhiều phương thức thanh toán, lọc giao dịch, xuất báo cáo chi tiết.</p>
          </div>
          <div class="card">
            <div class="icon">🔋</div>
            <h3>Quản lý pin</h3>
            <p class="muted">Theo dõi tình trạng pin, lịch bảo trì, tối ưu hóa hiệu suất.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="pricing">
      <div class="container">
        <h2>Gói dịch vụ</h2>
        <div class="pricing">
          <div class="card">
            <h3>Cơ bản</h3>
            <div class="price">89.000đ/lượt</div>
            <ul class="clean">
              <li><span class="tick">✓</span> Đổi pin tiêu chuẩn</li>
              <li><span class="tick">✓</span> App mobile</li>
              <li><span class="tick">✓</span> Thanh toán QR</li>
            </ul>
            <button class="btn btn-primary" onclick="showLogin()">Đăng ký ngay</button>
          </div>
          <div class="card featured">
            <h3>Premium <span class="chip">Phổ biến</span></h3>
            <div class="price">299.000đ/tháng</div>
            <ul class="clean">
              <li><span class="tick">✓</span> 8 lượt/tháng</li>
              <li><span class="tick">✓</span> Ưu tiên tại trạm</li>
              <li><span class="tick">✓</span> Hỗ trợ 24/7</li>
              <li><span class="tick">✓</span> Báo cáo chi tiết</li>
            </ul>
            <button class="btn btn-primary" onclick="showLogin()">Chọn gói</button>
          </div>
          <div class="card">
            <h3>Doanh nghiệp</h3>
            <div class="price">Liên hệ</div>
            <ul class="clean">
              <li><span class="tick">✓</span> Không giới hạn</li>
              <li><span class="tick">✓</span> API tích hợp</li>
              <li><span class="tick">✓</span> Dashboard quản lý</li>
              <li><span class="tick">✓</span> SLA 99.9%</li>
            </ul>
            <button class="btn" onclick="showContact()">Tư vấn</button>
          </div>
        </div>
      </div>
    </section>

    <section id="stations">
      <div class="container">
        <h2>Bản đồ trạm đổi pin</h2>
        <div class="map-container">
          <div id="map" style="height: 400px; border-radius: 12px; overflow: hidden;"></div>
        </div>
        <div class="station-info">
          <div class="grid stations">
            <div class="card" id="selected-station">
              <h3>Chọn trạm trên bản đồ</h3>
              <p class="muted">Click vào các marker để xem thông tin chi tiết trạm.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="contact">
      <div class="container">
        <h2>Liên hệ hỗ trợ</h2>
        <div class="contact-grid">
          <div class="card">
            <h3>📞 Hotline</h3>
            <p>1900 xxxx (24/7)</p>
            <p class="muted">Hỗ trợ khẩn cấp và tư vấn</p>
          </div>
          <div class="card">
            <h3>✉️ Email</h3>
            <p>support@doipin.vn</p>
            <p class="muted">Góp ý và hỗ trợ kỹ thuật</p>
          </div>
          <div class="card">
            <h3>📍 Văn phòng</h3>
            <p>Tầng 10, Tòa nhà FPT</p>
            <p class="muted">TP.HCM & Hà Nội</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footer-grid">
        <div>
          <h4>SWP201</h4>
          <p>Hệ thống đổi pin xe điện thông minh hàng đầu Việt Nam</p>
        </div>
        <div>
          <h4>Liên kết</h4>
          <a href="#features">Tính năng</a>
          <a href="#pricing">Bảng giá</a>
          <a href="#stations">Trạm</a>
        </div>
        <div>
          <h4>Hỗ trợ</h4>
          <a href="#contact">Liên hệ</a>
          <a href="#">Hướng dẫn</a>
          <a href="#">FAQ</a>
        </div>
      </div>
      <div class="footer-bottom">
        © 2025 SWP201 • Hệ thống quản lý thông minh
      </div>
    </div>
  </footer>

  <!-- Modals will be loaded dynamically -->
  <div id="modals-container"></div>
  
  <!-- Toast notification -->
  <div id="toast" class="toast"></div>

  <!-- External JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
  
  <!-- Internal JavaScript - Load in correct order -->
  <script src="src/assets/js/main.js"></script>
  <script src="src/assets/js/dashboard.js"></script>
  <script src="src/assets/js/payment.js"></script>
  <script src="src/components/modals.js"></script>
  
  <!-- Initialize app -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded');
      console.log('Auth object exists:', typeof auth !== 'undefined');
      console.log('handleLogin function exists:', typeof handleLogin !== 'undefined');
      console.log('showDashboard function exists:', typeof showDashboard !== 'undefined');
      console.log('createDashboard function exists:', typeof createDashboard !== 'undefined');
      
      // Test function
      window.testDashboard = function() {
        console.log('Testing dashboard creation...');
        createDashboard('user');
        const dashboard = document.getElementById('userDashboard');
        if (dashboard) {
          console.log('Dashboard created successfully');
          dashboard.style.display = 'block';
          dashboard.style.position = 'fixed';
          dashboard.style.top = '0';
          dashboard.style.left = '0';
          dashboard.style.width = '100%';
          dashboard.style.height = '100%';
          dashboard.style.zIndex = '9999';
          dashboard.style.background = 'var(--bg)';
          console.log('Dashboard should now be visible');
        } else {
          console.error('Dashboard not found after creation');
        }
      };
      
      // Test login function
      window.testLogin = function() {
        console.log('Testing login process...');
        const result = auth.login('user@demo.com', '123456', 'user');
        console.log('Login result:', result);
        if (result.success) {
          console.log('Login successful, showing dashboard...');
          showDashboard('user');
        } else {
          console.error('Login failed:', result.message);
        }
      };
      
      // Quick login bypass
      window.quickDashboard = function(role = 'user') {
        console.log('Quick dashboard test for role:', role);
        // Simulate successful login
        auth.currentUser = {
          username: 'test@demo.com',
          role: role,
          name: 'Test User'
        };
        auth.isLoggedIn = true;
        showDashboard(role);
      };
      
      // Debug dashboard visibility
      window.debugDashboard = function() {
        const dashboard = document.getElementById('userDashboard');
        if (dashboard) {
          console.log('Dashboard element found');
          console.log('Dashboard innerHTML length:', dashboard.innerHTML.length);
          console.log('Dashboard computed style:', window.getComputedStyle(dashboard));
          console.log('Dashboard position:', dashboard.getBoundingClientRect());
          
          // Force maximum visibility
          dashboard.style.cssText = `
            display: block !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 99999 !important;
            background: #0b1020 !important;
            color: white !important;
            overflow: auto !important;
          `;
          
          console.log('Applied forced styles to dashboard');
        } else {
          console.error('Dashboard element not found');
        }
      };
      
      // Initialize modals
      if (typeof initializeModals === 'function') {
        initializeModals();
      }
      
      // Check for existing session
      if (auth && typeof auth.checkSession === 'function') {
        if (auth.checkSession()) {
          console.log('Found existing session for:', auth.currentUser);
          showDashboard(auth.currentUser.role);
        }
      }
    });
  </script>
</body>
</html>