<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hợp đồng dịch vụ thuê pin & thanh toán</title>
  <style>
    :root{ --bg:#f7f9fc; --card:#fff; --muted:#5b6670; --accent:#0b69ff; --shadow: rgba(11,105,255,0.08); font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;}
    *{box-sizing:border-box}
    body{margin:20px;background:var(--bg);color:#0b1220}
    .container{max-width:900px;margin:0 auto;padding:22px;background:var(--card);border-radius:10px;box-shadow:0 8px 24px var(--shadow)}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px}
    header h1{font-size:18px;margin:0}
    .meta{color:var(--muted);font-size:13px}
    hr.sep{border:none;border-top:1px solid #eef3fb;margin:16px 0}
    label{display:block;font-weight:600;margin-top:12px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .col{flex:1;min-width:180px}
    input[type="text"], input[type="date"], textarea, select {
      width:100%;padding:8px;border:1px solid #e6eefc;border-radius:8px;background:#fbfdff;
      font-size:14px;color:#0b1220;
    }
    textarea{min-height:90px;resize:vertical;padding-top:10px}
    .small{font-size:13px;color:var(--muted)}
    .right{text-align:right}
    .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}
    button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
    button.ghost{background:transparent;border:1px solid #e6eefc;color:var(--accent);font-weight:600}
    /* contract content */
    .contract{margin-top:18px}
    .contract h2{text-align:center;margin:6px 0 4px;font-size:16px}
    .contract p{line-height:1.6;margin:8px 0}
    .clause{margin:10px 0;padding:12px;border-radius:8px;background:#fbfdff;border:1px solid #f1f6ff}
    .signature{display:flex;justify-content:space-between;margin-top:28px;gap:12px}
    .sig-box{width:48%;text-align:center}
    .print-note{font-size:13px;color:var(--muted);margin-top:8px}
    /* print */
    @media print{
      body{background:white}
      .actions, .no-print{display:none}
      .container{box-shadow:none;border-radius:0;padding:0}
    }
  </style>
</head>
<body>
  <div class="container" id="doc">
    <header>
      <div>
        <h1>HỢP ĐỒNG DỊCH VỤ THUÊ PIN & THANH TOÁN</h1>
        <div class="meta">Số: <span id="contract-number">…/2025/HĐDV</span></div>
      </div>
      <div class="right small">
        Ngày ký: <input type="date" id="sign-date" value="">
      </div>
    </header>

    <hr class="sep">

    <!-- Thông tin 2 bên -->
    <div>
      <label>Thông tin Bên A (Nhà cung cấp)</label>
      <div class="row">
        <div class="col"><input id="ba-name" type="text" placeholder="Tên công ty / tổ chức"></div>
        <div class="col"><input id="ba-rep" type="text" placeholder="Người đại diện"></div>
      </div>
      <div class="row">
        <div class="col"><input id="ba-address" type="text" placeholder="Địa chỉ"></div>
        <div class="col"><input id="ba-phone" type="text" placeholder="Số điện thoại"></div>
      </div>

      <label>Thông tin Bên B (Khách hàng)</label>
      <div class="row">
        <div class="col"><input id="bb-name" type="text" placeholder="Họ và tên / Tên cá nhân"></div>
        <div class="col"><input id="bb-id" type="text" placeholder="Số CMND/CCCD"></div>
      </div>
      <div class="row">
        <div class="col"><input id="bb-address" type="text" placeholder="Địa chỉ"></div>
        <div class="col"><input id="bb-phone" type="text" placeholder="Số điện thoại"></div>
      </div>
    </div>

    <div class="contract" id="contract-content">
      <h2>HỢP ĐỒNG DỊCH VỤ</h2>
      <p class="small">Căn cứ nhu cầu và khả năng, hai bên thống nhất ký kết hợp đồng với các điều khoản sau:</p>

      <div class="clause">
        <strong>Điều 1. Nội dung dịch vụ</strong>
        <p>Bên A cung cấp dịch vụ thuê pin & đổi pin cho phương tiện điện của Bên B theo hai hình thức:</p>
        <ol>
          <li><strong>Thanh toán theo lượt:</strong> <span id="price-per-swap-text">10.000 VNĐ / lượt</span>.</li>
          <li><strong>Gói thuê pin (theo tháng):</strong> <span id="price-sub-text">200.000 VNĐ / tháng (tối đa 30 lượt)</span>.</li>
        </ol>
      </div>

      <div class="clause">
        <strong>Điều 2. Quyền và nghĩa vụ</strong>
        <p><strong>Bên A:</strong> Cung cấp pin đạt chất lượng, hỗ trợ kỹ thuật, cấp hóa đơn và lịch sử giao dịch.</p>
        <p><strong>Bên B:</strong> Thanh toán đúng hạn, sử dụng pin đúng mục đích, hoàn trả theo thoả thuận.</p>
      </div>

      <div class="clause">
        <strong>Điều 3. Thời hạn hợp đồng</strong>
        <p>Hợp đồng có hiệu lực từ ngày ký và kéo dài <input id="duration" placeholder="số tháng" style="width:120px;padding:6px;border-radius:6px;border:1px solid #e6eefc"> tháng. Gia hạn khi có thỏa thuận bằng văn bản.</p>
      </div>

      <div class="clause">
        <strong>Điều 4. Giá và phương thức thanh toán</strong>
        <p>Giá áp dụng như Điều 1. Thanh toán có thể thực hiện bằng tiền mặt, chuyển khoản hoặc ví điện tử (MoMo, VNPay).</p>
        <p class="small">Thanh toán theo gói: thanh toán trước khi sử dụng gói. Thanh toán theo lượt: thanh toán ngay sau mỗi lần đổi pin.</p>
      </div>

      <div class="clause">
        <strong>Điều 5. Điều khoản chung</strong>
        <p>Hai bên cam kết thực hiện đúng hợp đồng. Mọi tranh chấp ưu tiên thương lượng; nếu không thành sẽ giải quyết tại Tòa án có thẩm quyền.</p>
      </div>

      <div class="signature">
        <div class="sig-box">
          <div style="font-weight:700">ĐẠI DIỆN BÊN A</div>
          <div class="small">Ký, ghi rõ họ tên, đóng dấu</div>
          <div style="height:64px"></div>
          <div id="ba-sign-name" class="small" style="margin-top:6px"></div>
        </div>
        <div class="sig-box">
          <div style="font-weight:700">ĐẠI DIỆN BÊN B</div>
          <div class="small">Ký, ghi rõ họ tên</div>
          <div style="height:64px"></div>
          <div id="bb-sign-name" class="small" style="margin-top:6px"></div>
        </div>
      </div>

      <div class="print-note small">*Lưu ý: Thay thế nội dung phù hợp với pháp lý & điều kiện thực tế trước khi ký.</div>
    </div>

    <!-- Controls -->
    <div class="actions no-print">
      <button onclick="fillSample()">Điền mẫu giá & ngày</button>
      <button class="ghost" onclick="preview()" title="Cập nhật nội dung hiện tại">Cập nhật hợp đồng</button>
      <button onclick="printDoc()">In / Xuất PDF</button>
      <button onclick="downloadDoc()">Tải .doc (có thể mở bằng Word)</button>
    </div>
  </div>

  <script>
    // Helper: format money
    function formatMoney(v){
      return v.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + ' VNĐ';
    }

    // Fill sample default values
    function fillSample(){
      document.getElementById('ba-name').value = 'Công ty TNHH PinX';
      document.getElementById('ba-rep').value = 'Nguyễn Văn A';
      document.getElementById('ba-address').value = 'Số 1, Đường A, Quận B, TP.';
      document.getElementById('ba-phone').value = '0901234567';

      document.getElementById('bb-name').value = 'Trần Thị B';
      document.getElementById('bb-id').value = '012345678';
      document.getElementById('bb-address').value = 'Địa chỉ khách hàng';
      document.getElementById('bb-phone').value = '0987654321';

      // prices
      const perSwap = 10000;
      const sub = 200000;
      document.getElementById('price-per-swap-text').textContent = formatMoney(perSwap) + ' / lượt';
      document.getElementById('price-sub-text').textContent = formatMoney(sub) + ' / tháng (tối đa 30 lượt)';

      // contract number and date
      document.getElementById('contract-number').textContent = '001/2025/HĐDV';
      const today = new Date().toISOString().slice(0,10);
      document.getElementById('sign-date').value = today;
      document.getElementById('ba-sign-name').textContent = document.getElementById('ba-rep').value;
      document.getElementById('bb-sign-name').textContent = document.getElementById('bb-name').value;
      document.getElementById('duration').value = '12';
      alert('Đã điền mẫu mặc định. Bạn có thể chỉnh lại nội dung trước khi in/tải.');
    }

    // Update contract content placeholders from form values
    function preview(){
      document.getElementById('ba-sign-name').textContent = document.getElementById('ba-rep').value || '';
      document.getElementById('bb-sign-name').textContent = document.getElementById('bb-name').value || '';
      // if user changed prices manually (optional)
      // contract-number & date already bound in inputs
      alert('Nội dung hợp đồng đã được cập nhật.');
    }

    // Print / Save as PDF via browser print
    function printDoc(){
      preview(); // ensure updated
      window.print();
    }

    // Download as .doc (HTML inside) — opens in Word
    function downloadDoc(){
      preview();
      const header = "<html><head><meta charset='utf-8'><title>Hợp đồng</title></head><body>";
      const footer = "</body></html>";
      // clone the contract area and inline basic styles for doc
      const content = document.getElementById('doc').outerHTML;
      const html = header + content + footer;
      const blob = new Blob([html], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = "Hop_dong_thue_pin.doc";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      setTimeout(()=> URL.revokeObjectURL(url), 1000);
    }

    // auto-fill today's date if empty
    (function init(){
      const d = document.getElementById('sign-date');
      if(!d.value) d.value = new Date().toISOString().slice(0,10);
    })();
  </script>
</body>
</html>
